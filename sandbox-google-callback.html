<!DOCTYPE html>
<html lang="fr">
<head>
<meta charset="UTF-8">
<title>Connexion ODA...</title>
<script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
<style>
    body{font-family:Inter,sans-serif;display:flex;align-items:center;
    justify-content:center;min-height:100vh;background:#1a1a2e;color:white;text-align:center;}
    .spinner{width:40px;height:40px;border:4px solid rgba(255,255,255,0.2);
    border-top-color:#FF6B00;border-radius:50%;animation:spin 0.8s linear infinite;margin:0 auto 16px;}
    @keyframes spin{to{transform:rotate(360deg)}}
</style>
</head>
<body>
<div>
    <div class="spinner"></div>
    <div style="font-weight:700;font-size:1rem;">VÃ©rification en cours...</div>
    <div style="font-size:0.8rem;opacity:0.5;margin-top:6px;">ODA Vendeur</div>
</div>
<script>
(async () => {
    const sb = window.supabase.createClient(
        'https://xjckbqbqxcwzcrlmuvzf.supabase.co',
        'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InhqY2ticWJxeGN3emNybG11dnpmIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjA1MTk1MzMsImV4cCI6MjA3NjA5NTUzM30.AMzAUwtjFt7Rvof5r2enMyYIYToc1wNWWEjvZqK_YXM'
    );
    const { data: { session } } = await sb.auth.getSession();
    if (!session?.user) { window.location.href = 'oda-achats.html'; return; }

    const { data: boutique } = await sb
        .from('parametres_boutique')
        .select('user_id')
        .eq('user_id', session.user.id)
        .single();

    if (boutique) {
        window.location.href = 'sandbox.html';
    } else {
        await sb.auth.signOut();
        window.location.href = 'oda-achats.html';
    }
})();
</script>
</body>
</html>